{% extends "base.html" %}
{% load static %}

{% block title %}SkidkoScan — реальные скидки{% endblock %}

{% block content %}

<h1 class="page-title">Популярные товары со скидками</h1>

{% if products %}
    <div class="products-grid">
        {% for product in products %}
            <article class="product-card">
                <a href="{% url 'product_detail' product.id %}" class="product-link">

                    <div class="product-image-wrapper">
                        {% if product.image_url %}
                            <img src="{{ product.image_url }}"
                                 alt="{{ product.title_ru|default:product.title_en }}"
                                 class="product-image">
                        {% else %}
                            <div class="product-image placeholder">
                                Нет изображения
                            </div>
                        {% endif %}
                    </div>

                    <div class="product-info">

                        <h2 class="product-title">
                            {{ product.title_ru|default:product.title_en }}
                        </h2>

                        <div class="product-prices">
                            <span class="product-price">
                                {{ product.price }} {{ product.currency }}
                            </span>

                            {% if product.old_price and product.old_price > product.price %}
                                <span class="product-old-price">
                                    {{ product.old_price }} {{ product.currency }}
                                </span>
                                <span class="product-discount-badge">
                                    Скидка
                                </span>
                            {% endif %}
                        </div>

                        {% if product.category %}
                            <div class="product-category">
                                {{ product.category.name_ru|default:product.category.name_en }}
                            </div>
                        {% endif %}

                    </div>

                </a>
            </article>
        {% endfor %}
    </div>

{% else %}
    <p>Пока нет товаров для отображения.</p>
{% endif %}

<!-- ПАГИНАЦИЯ -->
{% if page_obj.paginator.num_pages > 1 %}
<div class="pagination">

    {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}" class="pagination-btn nav-btn">
            ← Назад
        </a>
    {% else %}
        <span class="pagination-btn nav-btn disabled">← Назад</span>
    {% endif %}

    <span class="pagination-current">
        Страница {{ page_obj.number }} из {{ page_obj.paginator.num_pages }}
    </span>

    {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}" class="pagination-btn nav-btn">
            Вперёд →
        </a>
    {% else %}
        <span class="pagination-btn nav-btn disabled">Вперёд →</span>
    {% endif %}

</div>
{% endif %}

{% endblock %}
