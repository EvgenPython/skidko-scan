<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}SkidkoScan{% endblock %}</title>

    {% load static %}
    <link rel="stylesheet" href="{% static 'css/main.css' %}">


</head>

<body>

<header class="main-header">



    <div class="container header-top">

        <!-- –õ–û–ì–û -->
        <a href="{% url 'index' %}" class="header-logo">
            SkidkoScan
        </a>

        <!-- –ü–û–ò–°–ö -->
        <form action="{% url 'product_search' %}" method="get" class="header-search">
            <input type="text" name="q" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞..." value="{{ search_query|default:'' }}">
            <button type="submit">üîç</button>
        </form>

        <!-- –ê–ö–ö–ê–£–ù–¢ -->
        <div class="header-user">
            <a href="#" class="user-link">–í–æ–π—Ç–∏</a>
        </div>

        <!-- –ë–£–†–ì–ï–† -->
        <div class="header-burger" onclick="toggleMobileMenu()">
            ‚ò∞
        </div>
    </div>

    <!-- ============ –î–ï–°–ö–¢–û–ü–ù–û–ï –ú–ï–ù–Æ ============ -->
    <nav class="header-categories">
        <ul class="cat-menu">

            {% for cat in categories %}
                <li class="cat-item">

                    <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏—è -->
                    <a href="{% url 'category_view' cat.id %}" class="cat-link">
                        {{ cat.name_ru|default:cat.name_en }}
                    </a>

                    <!-- –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
                    {% if cat.subcategories.all %}
                        <ul class="subcat-menu">
                            {% for sub in cat.subcategories.all %}
                                <li>
                                    <a href="{% url 'subcategory_view' sub.id %}">
                                        {{ sub.name_ru|default:sub.name_en }}
                                    </a>
                                </li>
                            {% endfor %}
                        </ul>
                    {% endif %}

                </li>
            {% endfor %}

        </ul>
    </nav>

    <!-- ============ –ú–û–ë–ò–õ–¨–ù–û–ï –ú–ï–ù–Æ ============ -->
    <nav id="mobileMenu" class="mobile-categories">
        <ul class="mobile-cat-menu">

            {% for cat in categories %}
                <li class="mobile-cat-item">

                    <!-- –®–∞–ø–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
                    <div class="mobile-cat-header" onclick="toggleSubcats({{ cat.id }})">
                        <a href="{% url 'category_view' cat.id %}">
                            {{ cat.name_ru|default:cat.name_en }}
                        </a>

                        {% if cat.subcategories.all %}
                            <span class="mobile-arrow">‚ñº</span>
                        {% endif %}
                    </div>

                    <!-- –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
                    {% if cat.subcategories.all %}
                        <ul id="subcat-{{ cat.id }}" class="mobile-subcats">
                            {% for sub in cat.subcategories.all %}
                                <li>
                                    <a href="{% url 'subcategory_view' sub.id %}">
                                        {{ sub.name_ru|default:sub.name_en }}
                                    </a>
                                </li>
                            {% endfor %}
                        </ul>
                    {% endif %}

                </li>
            {% endfor %}

        </ul>
    </nav>

</header>

<!-- JS –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é -->
<script>
    function toggleMobileMenu() {
        document.getElementById('mobileMenu').classList.toggle('open');
    }

    function toggleSubcats(id) {
        const el = document.getElementById('subcat-' + id);
        if (el) el.classList.toggle('open');
    }
</script>

<!-- ============ –ö–û–ù–¢–ï–ù–¢ ============ -->
<main class="container">
    {% block content %}{% endblock %}
</main>

<!-- ============ –§–£–¢–ï–† ============ -->
<footer class="footer">
    <div class="container">
        ¬© {{ now|date:"Y" }} SkidkoScan ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–∫–∏–¥–æ–∫
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</body>
</html>
